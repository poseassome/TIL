# 인덱스 활용, 뷰 활용
작성일시: 2021년 11월 25일 오후 1:54

## INDEX

데이터를 빠르게 찾을 수 있는 수단.

테이블에 대한 조회 속도를 높여 주는 자료 구조

Primary key column은 자동으로 인덱스가 생성된다.

---

## 인덱스 준비

### 1. 인덱스 생성

```sql
create [UNIQUE] index 인덱스이름 on 테이블이름 (열 이름);

UNIQUE : 인덱스 컬럼에 중복값을 허용하지 않는다는 의미, 생략 가능
(열 이름) : 복수 컬럼 지정 가능하다. (열 이름1, 열 이름2,...)
```

### 2. 인덱스 삭제

```sql
drop index 인덱스이름
```

### 3. 인덱스 변경 (변경하는 경우는 드물다.)

```sql
alter [UNIQUE] index 인덱스이름 on 테이블이름 (열 이름)
```

### 4. 인덱스 삭제

```sql
alter table 테이블이름 drop index 인덱스이름
```

### 4. 인덱스 조회

```sql
show index from 테이블이름
```

---

## VIEW

논리 테이블로, 사용자에게(생성 아닌 사용 관점에서) 테이블과 동일하다.

뷰는 하나의 물리 테이블로부터 생성가능하며, 다수의 테이블 또는 다른 뷰를 이용해 만들 수 있다.

`하나의 뷰`를 통해 뷰를 구성하는 `복수의 테이블`을 태체하는 단순성에 의믜가 있다.

> **뷰의 장점**
>
1. **논리적 독립성 제공**
뷰는 논리테이블이다. (테이블의 구조가 변경되어도 뷰를 사용하는 응용 프로그램은 변경하지 않아도 됨)
2. **사용자 데이터 관리 용이**
복수 테이블에 존재하는 여러 종류의 데이터에 대해 단순한 질의어 사용이 가능함
3. **데이터 보안 용이**
중요 보안 데이터를 저장 중인 테이블에는 접근이 불허하고, 해당 테이블의 일부 정보만을 볼 수 있는 뷰에는 접근을 허용하는 방식으로 보안 데이터에 대한 접근 제어 가능

> **뷰의 단점**
>
1. **뷰 자체 인덱스 불가**
인덱스는 물리적으로 저장된 데이터를 대상으로 하기에 논리적 구성인 뷰 자체는 인덱스를 가지지 못함.
2. **뷰 정의 변경 불가**
뷰의 정의를 변경하려면 뷰를 삭제하고 재생성하여야 함
3. **데이터 변경 제약 존재**
뷰의 내용에 대한 삽입, 삭제, 변경 제약이 있음

---

## 뷰 사용

### 1. 뷰 생성

```sql
1. 테이블 그대로
create view 뷰이름 as select * from 테이블이름;

2. 테이블 일부 컬럼
create view 뷰이름 as select 컬럼1, 컬럼2, ... from 테이블이름;
create view 뷰이름 as select 컬럼1, 컬럼2, ... from 테이블이름 where 컬럼명 in ('값1','값2',..);

3. 두 개의 테이블 조인
create view 뷰이름 as select * from 테이블이름1 a, 테이블이름2 b where a.컬럼1=b.col1;

// a, b는 테이블의 별칭
```

```sql
계산식을 사용할 수도 있다.

ex) 근무일수 구하기
create view check_workday_view (UID, name, joinday, workdays) as select UID, name, joinday, (Now()-Date(joinday)) from EMP;
```

### 2. 뷰 삭제

```sql
drop view 뷰이름;
```

### 3. 뷰 조회

```sql
select * from 뷰이름;
```

### *뷰 내용 변경*

| 경우 | 변경여부 |
| --- | --- |
| 뷰가 하나의 테이블에서 정의된 경우 | 가능 |
| 뷰 생성에 사용된 테이블의 PK를 포함하는 경우 | 가능 |
| 뷰 정의에서 집계 함수로 정의된 컬럼이 있는 경우 | 불가능 |
| 뷰 정의에서 DISTINCT가 포함된 경우 | 불가능 |
| 뷰 정의에서 GROUP BY 또는 HAVING이 포함된 경우 | 불가능 |
| 뷰 정의에서 서브쿼리가 포함된 경우 | 불가능 |
| 뷰 정의에서 상수, 문자열 등이 포함된 경우 | 불가능 |

---