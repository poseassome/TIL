# íšŒì›ì •ë³´ ìˆ˜ì •
ì‘ì„±ì¼ì‹œ: 2021ë…„ 12ì›” 7ì¼ ì˜¤í›„ 3:13

### ë””ë ‰í† ë¦¬ êµ¬ì„±

- ğŸ“htdocs
    - ğŸ“website

        ğŸ“index.php

        - ğŸ“inc

            ğŸ“dbcon.php

        - ğŸ“members

            ğŸ“join.php

            ğŸ“insert.php

            ğŸ“searchID.php

            ğŸ“result.php

            ğŸ“search_addr.php

            ğŸ“result_addr.php

            ğŸ“welcome.php

            **ğŸ“edit.php *(new)***

            **ğŸ“edit_ok.php *(new)***

        - ğŸ“login

            ğŸ“login.php

            ğŸ“login_ok.php

            ğŸ“logout.php


**members**ì— `edit.php`, `edit_ok.php`ë¥¼ ì¶”ê°€í–ˆë‹¤.

---

## íšŒì›ì •ë³´ ìˆ˜ì • í˜ì´ì§€ (edit.php)

íšŒì›ì •ë³´ ìˆ˜ì • í˜ì´ì§€ëŠ” íšŒì›ê°€ì… í˜ì´ì§€(`join.php`)ì™€ ìœ ì‚¬í•˜ë‹¤.

í•˜ì§€ë§Œ íšŒì›ê°€ì…ì²˜ëŸ¼ ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•  í•„ìš”ëŠ” ì—†ê³ ,
ì¼ë¶€ ì •ë³´ë§Œ ì…ë ¥ ê°€ëŠ¥í•˜ê³  **ì´ë¦„ê³¼ ì•„ì´ë””ëŠ” ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥**í•˜ë‹¤ëŠ” ì°¨ì´ê°€ ìˆë‹¤.

ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  í•´ë‹¹ `data`ë¥¼ `<input>` `value=""`ì— ë‹´ì•„ì„œ ì¶œë ¥í•œë‹¤.

```php
<?php
	session_start();

	/* ë¡œê·¸ì¸ ì‚¬ìš©ì */
	$s_idx = $_SESSION["s_idx"];

	/* DB ì—°ê²° */
	include "../inc/dbcon.php";

	/* ì¿¼ë¦¬ ì‘ì„± */
	$sql = "select * from members where idx = $s_idx;";

	/* ì¿¼ë¦¬ ì „ì†¡ */
	$result = mysqli_query($dbcon, $sql);

	/* ê²°ê³¼ ê°€ì ¸ì˜¤ê¸° */
	$array = mysqli_fetch_array($result);
?>
```

íšŒì›ì •ë³´ ìˆ˜ì • í˜ì´ì§€ì— ë§ê²Œ ìœ íš¨ì„± ê²€ì‚¬ `<script>`ë„ ìˆ˜ì •í•œë‹¤.

ë¹„ë°€ë²ˆí˜¸ì™€ ì „í™”ë²ˆí˜¸ëŠ” ê°’ì´ ì¡´ì¬í•  ë•Œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•œë‹¤.

ê°’ì„ ë¶ˆëŸ¬ì˜¬ ìë¦¬ì—ëŠ” `<?phpechoë¶ˆëŸ¬ì˜¬ë³€ìˆ˜;?>` ë¡œ ëŒ€ì²´í•œë‹¤.

**ìƒë…„ì›”ì¼**ì˜ ê²½ìš°, DBì— ì €ì¥ëœ ì •ë³´ëŠ” **yyyy-mm-dd** í˜•ì‹ìœ¼ë¡œ
ë¶ˆëŸ¬ì˜¬ ë•Œ **yyyymmdd** í˜•ì‹ìœ¼ë¡œ ë°”ê¾¸ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.

**ì „í™”ë²ˆí˜¸**ì˜ ê²½ìš°, DBì— ì €ì¥ëœ ì •ë³´ëŠ” **0000-0000-0000**í˜•ì‹ìœ¼ë¡œ
ë¶ˆëŸ¬ì˜¬ ë•Œ **000000000000** í˜•ì‹ìœ¼ë¡œ ë°”ê¾¸ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.

### **ë¬¸ìë¥¼ ì¹˜í™˜í•´ì£¼ëŠ” í•¨ìˆ˜**

`**str_replace("ì–´ë–¤ ë¬¸ìë¥¼", "ì–´ë–¤ ë¬¸ìë¡œ", "ì–´ë–¤ ë¬¸ìì—ì„œ");**`

â‡’ `$birth=str_replace("-", "", $array["birth"]);`

- *ì¸í„°ë„· ê²€ìƒ‰*

    `$birth =date("Ymd", $array["birth"]);`


â‡’ `$mobile=str_replace("-", "", $array["mobile]);`

**ì´ë©”ì¼**ì˜ ê²½ìš°, DBì— ì €ì¥ëœ ì •ë³´ëŠ” **email_ID@email_DOMAIN** í˜•ì‹ìœ¼ë¡œ
ë¶ˆëŸ¬ì˜¬ ë•Œ **email_ID** / **email_DOMAIN** ë”°ë¡œ ë¶„ë¦¬í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.

### ë¬¸ì¥ì„ ë¶„ë¦¬í•˜ëŠ” í•¨ìˆ˜

`**explode("ê¸°ì¤€ë¬¸ì", "ì–´ë–¤ ë¬¸ì¥ì—ì„œ");**`

â‡’ `$email=explode("@", $array["email"]);`

ë¶„ë¦¬í•œ ê°’ì€ ë°°ì—´ì„ ì‚¬ìš©í•œë‹¤.

**email_ID : $email[0]**

**email_DOMAIN : $email[1]**

```php
<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íšŒì›ê°€ì…</title>
  <style>
	  * {box-sizing: border-box;}
	  #u_name, #u_id, #pwd, #repwd, #birth, #mobile,
		#email_id, #email_dns {width: 200px; height: 25px;}
	  #postalCode {height: 25px; width: 120px;}
	  #addr1, #addr2 {width: 250px; height: 25px;}
	  p {overflow: hidden;}
	  p:last-child {text-align: center;}
	  legend {text-align: center; font-size: 18px;}
	  span {display: block; font-size: 14px; color: red; text-indent: 125px;}
	  label, .txt {display: inline-block; width: 120px; line-height: 20px; color: black; text-indent: 0;}
	  select {width: 150px; height: 25px; border: 1px solid;}
		button {background: black; color: #fff; cursor: pointer;}
	  #agree {width: 20px; height: 20px; margin: 0 10px; float: left;}
	  #agree+label {display: block; float: left;}
  </style>
  <script>
	  function edit_check() {
	    var pwd = document.getElementById("pwd");
	    var repwd = document.getElementById("repwd");
	    var mobile = document.getElementById("mobile");

	    // ë¹„ë°€ë²ˆí˜¸
	    if (pwd.value) {
	      var regpwd = /^(?=.*[a-zA-Z])(?=.*[0-9]).{4,12}$/;
	      if (!regpwd.test(pwd.value)) {
	        var err_txt = document.querySelector(".err_pwd");
	        err_txt.textContent = "ë¹„ë°€ë²ˆí˜¸ëŠ” 4~12ê¸€ì ìˆ«ì, ì˜ì–´ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.";
	        pwd.focus();
	        return false;
	      };
	    };
	    // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
	    if (pwd.value) {
	      if (pwd.value != repwd.value) {
	        var err_txt = document.querySelector(".err_repwd");
	        err_txt.textContent = "ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.";
	        repwd.focus();
	        return false;
	      };
	    };

	    // ì „í™”ë²ˆí˜¸
	    if (mobile.value) {
	      var reg_mobile = /^[0-9]{10,11}$/g;
	      if (!reg_mobile.test(mobile.value)) {
	        var err_txt = document.querySelector(".err_mobile");
	        err_txt.textContent = "ì „í™”ë²ˆí˜¸ëŠ” ìˆ«ìë§Œ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
	        mobile.focus();
	        return false;
	      };
	    };

	    // ìƒë…„ì›”ì¼
	    var reg_birth = /^[0-9]{8}$/g;
	    if (!reg_birth.test(birth.value)) {
	      var err_txt = document.querySelector(".err_birth");
	      err_txt.textContent = "ìƒë…„ì›”ì¼ì€ ìˆ«ìë§Œ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
	      birth.focus();
	      return false;
	    };
	  };

	  // ì´ë©”ì¼
	  function change_email() {
	    var email_dns = document.getElementById("email_dns");
	    var email_sel = document.getElementById("email_sel");
	    var idx = email_sel.options.selectedIndex;
	    var sel_txt = email_sel.options[idx].value;
	    email_dns.value = sel_txt;
	  };

	  // ì£¼ì†Œê²€ìƒ‰
	  function addr_search() {
	    window.open("search_addr.php", "", "width=600, height=400, left=0, top=0");
	  }
  </script>
</head>

<body>
  <form name="edit_form" action="edit.php" method="post" onsubmit="return edit_check()">
    <fieldset>
      <legend>íšŒì› ì •ë³´ìˆ˜ì •</legend>
      <p>
        <span class="txt">ì´ë¦„</span>
        <?php echo $array["u_name"]; ?>
      </p>
      <p><span class="txt">ì•„ì´ë””</span>
        <?php echo $array["u_id"]; ?>
      </p>
      <p><label for="pwd">ë¹„ë°€ë²ˆí˜¸</label>
        <input type="password" name="pwd" id="pwd" class="pwd">
        <span class="err_pwd">* ë¹„ë°€ë²ˆí˜¸ëŠ” 4~12ê¸€ìë§Œ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
      </p>
      <p><label for="repwd">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
        <input type="password" name="repwd" id="repwd" class="repwd">
        <span class="err_repwd"></span>
      </p>
      <?php
      /* ë¬¸ì ì¹˜í™˜í•´ì£¼ëŠ” í•¨ìˆ˜
        str_replace("ì–´ë–¤ ë¬¸ìë¥¼", "ì–´ë–¤ ë¬¸ìë¡œ", "ì–´ë–¤ ë¬¸ìì—ì„œ"); */
        $birth = str_replace("-","", $array["birth"]);

        // ë‚´ê°€ ì¸í„°ë„· ê²€ìƒ‰í•´ì„œ ì°¾ì€ ê²ƒ
        // $birth = date("Ymd", $array["birth"]);
      ?>
      <p><label for="birth">ìƒë…„ì›”ì¼</label>
        <input type="text" name="birth" id="birth" class="birth" value="<?php echo $birth; ?>">
        <span class="err_birth"> *ex)20211022 </span>
      </p>
      <p><label for="postalCode">ìš°í¸ë²ˆí˜¸</label>
        <input type="text" name="postalCode" id="postalCode" class="postalCode" size="5"
          value="<?php echo $array["postalCode"]; ?>">
        <button type="button" name="" id="" class="btn" onclick="addr_search()">ì£¼ì†Œê²€ìƒ‰</button><br>
        <label for="addr1">ê¸°ë³¸ì£¼ì†Œ</label>
        <input type="text" name="addr1" id="addr1" class="addr1" value="<?php echo $array["addr1"]; ?>"><br>
        <label for="addr2">ìƒì„¸ì£¼ì†Œ</label>
        <input type="text" name="addr2" id="addr2" class="addr2" value="<?php echo $array["addr2"]; ?>">
      </p>
      <?php
      /* ë¬¸ì¥ì„ ë¶„ë¦¬í•˜ëŠ” í•¨ìˆ˜
        explode("ê¸°ì¤€ë¬¸ì", "ì–´ë–¤ ë¬¸ì¥ì—ì„œ"); */
        $email = explode("@", $array["email"]);
      ?>
      <p><label for="email_id">ì´ë©”ì¼</label>
        <input type="text" name="email_id" id="email_id" class="email_id" value="<?php echo $email[0]; ?>">
        @
        <input type="text" name="email_dns" id="email_dns" class="email_dns" value="<?php echo $email[1]; ?>">
        <select name="email_sel" id="email_sel" class="email_sel" onchange="change_email()">
          <option value="">ì§ì ‘ì…ë ¥</option>
          <option value="naver.com">NAVER</option>
          <option value="daum.net">DAUM</option>
          <option value="google.com">GOOGLE</option>
        </select>
      </p>
      <?php
        $mobile = str_replace("-", "", $array["mobile"]);
      ?>
      <p><label for="mobile">ì „í™”ë²ˆí˜¸</label>
        <input type="text" name="mobile" id="mobile" class="mobile" value="<?php echo $mobile; ?>">
        <span class="err_mobile">"-"ì—†ì´ ìˆ«ìë§Œ ì…ë ¥</span>
      </p>
      <p>
        <button type="button" class="btn" onclick="history.back()">ì´ì „ìœ¼ë¡œ</button>
        <button type="submit" class="btn">ì •ë³´ìˆ˜ì •</button>
      </p>
    </fieldset>
  </form>
</body>

</html>
```

![ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸í•œ edit.php](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/7bf27308-e425-4beb-a25d-2f9ae96730ed/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211220T084025Z&X-Amz-Expires=86400&X-Amz-Signature=959fd9331ab8a9f5ffe123f40e5af2024d1093c9d2c8dde05f41541038ea6404&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸í•œ edit.php

---

## íšŒì›ì •ë³´ ìˆ˜ì • ì²˜ë¦¬ í˜ì´ì§€ (edit_ok.php)

ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì •ë³´ë¥¼ DBì— ë°˜ì˜í•˜ë„ë¡ í•˜ëŠ” ì²˜ë¦¬í˜ì´ì§€(`edit_ok.php`)ë¥¼ ì‘ì„±í•œë‹¤.

1. ì„¸ì…˜ ì‹œì‘
2. ì´ì „ í˜ì´ì§€ì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°
3. DB ì—°ê²°
4. ì¿¼ë¦¬ì‘ì„±
5. ì¿¼ë¦¬ì „ì†¡
6. DBì—ì„œ ê²°ê³¼ê°’ ê°€ì ¸ì˜¤ê¸°
7. ì¡°ê±´ì²˜ë¦¬

### 1. ì„¸ì…˜ ì‹œì‘

ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

```php
<?php
	session_start();
	$s_idx = $_SESSION["s_idx"];
?>
```

### 2. ì´ì „ í˜ì´ì§€ì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°

ì´ì „ í˜ì´ì§€(`edit.php`)ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ì§€ë§Œ,
**ë¹„ë°€ë²ˆí˜¸**ëŠ” ìˆì„ ìˆ˜ë„ ìˆê³  ì—†ì„ ìˆ˜ë„ ìˆë‹¤.

ë¶„ë¦¬ëœ **ì´ë©”ì¼**ì€ ë‹¤ì‹œ ì—°ê²°í•´ì„œ ê°€ì ¸ì˜¨ë‹¤.

```php
<?php
	$pwd = $_POST["pwd"];
	$birth = $_POST["birth"];
	$postalCode = $_POST["postalCode"];
	$addr1 = $_POST["addr1"];
	$addr2 = $_POST["addr2"];
	$email = $_POST["email_id"]."@".$_POST["email_dns"];
	$mobile = $_POST["mobile"];
?>
```

### 3. DB ì ‘ì† / ì¿¼ë¦¬ ì‘ì„± / ì¿¼ë¦¬ ì „ì†¡

ìˆ˜ì •ëœ ì •ë³´ë¥¼ DBì— ë°˜ì˜í•˜ê¸° ìœ„í•´ì„œëŠ” `**update**`ë¬¸ì„ ì‘ì„±í•œë‹¤.

*`update í…Œì´ë¸”ëª… set í•„ë“œëª…=ê°’, í•„ë“œëª…=ê°’, ...;`*

**ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìœ ë¬´**ì— ë”°ë¼ ë°˜ì˜ë˜ëŠ” ë°ì´í„°ê°€ ë‹¬ë¼ì§€ë¯€ë¡œ
ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•œë‹¤.

```php
<?php
	include "../inc/dbcon.php";

	if(!$pwd){  //<--ë¹„ë°€ë²ˆí˜¸ ë³€ê²½x
	  $sql = "update members set birth='$birth', postalCode='$postalCode', addr1='$addr1', addr2='$addr2', email='$email', mobile='$mobile' where idx = '$s_idx';";
	}else{  //<--ë¹„ë°€ë²ˆí˜¸ ë³€ê²½o
	  $sql = "update members set pwd='$pwd', birth='$birth', postalCode='$postalCode', addr1='$addr1', addr2='$addr2', email='$email', mobile='$mobile' where idx = '$s_idx';";
	};

	mysqli_query($dbcon, $sql);
?>
```

### 4. DB ì—°ê²° ì¢…ë£Œ / ë¦¬ë””ë ‰ì…˜

ë°ì´í„° ì „ì†¡ í›„ DBì—°ê²°ì„ ì¢…ë£Œí•˜ê³  ì´ì „ í˜ì´ì§€(`edit.php`)ë¡œ ëŒì•„ê°„ë‹¤.

```php
<?php
	mysqli_close($dbcon);

	echo "
	  <script type=\"text/javascript\">
	    alert(\"ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.\");
	    location.href=\"edit.php\";
	  </script>
	";
?>
```

---