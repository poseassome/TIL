# ì•„ì´ë”” ì¤‘ë³µê²€ìƒ‰
ì‘ì„±ì¼ì‹œ: 2021ë…„ 12ì›” 6ì¼ ì˜¤í›„ 2:17

## DB ì—°ê²° ë°©ì‹ ìˆ˜ì •

`insert.php`ì—ì„œ ì´ˆê¸° **Database ì—°ê²°**

`$dbcon = mysqli_connect("localhost", "root", "", "front") or die("ì ‘ì†ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.");
mysqli_set_charset($dbcon,"utf8");`

ë¬¸ì„œì— ì§ì ‘ ì‘ì„±í•˜ëŠ” ë°©ë²• ëŒ€ì‹  DBì—°ê²°ìš© phpíŒŒì¼(=dbcon.php)ì„ ë§Œë“¤ì–´ì„œ
í•´ë‹¹ íŒŒì¼ì„ í•„ìš”í•  ë•Œë§ˆë‹¤ ë¬¸ì„œì— ë¶ˆëŸ¬ì˜¨ë‹¤.

`include "../inc/dbcon.php";`

---

### ì•„ì´ë”” ì¤‘ë³µê²€ìƒ‰ í˜ì´ì§€ method

*searchID.php*

```php
<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì•„ì´ë”” ì¤‘ë³µ ê²€ìƒ‰</title>
  <script>
  window.onload = function() {
    var inputId = document.getElementById("input_id");
    inputId.value = opener.document.getElementById("u_id").value
  };
  </script>
</head>

<body>
  <form name="search_id_form" action="result.php" method="**post**">
    <fieldset>
      <legend>ì•„ì´ë”” ì…ë ¥</legend>
      <p>
        <label for="">ì•„ì´ë””</label>
        <input type="text" name="input_id" id="input_id" value="">
        <button type="submit">ê²€ìƒ‰</button>
      </p>
    </fieldset>
  </form>
</body>

</html>
```

---

## ì•„ì´ë”” ì¤‘ë³µê²€ìƒ‰ ì²˜ë¦¬ ë° ê²°ê³¼

í•´ë‹¹ í˜ì´ì§€(`result.php`)ì—ì„œ **PHP**ë¡œ ì²˜ë¦¬í•  ë‹¨ê³„ëŠ” **5ë‹¨ê³„**ê°€ ìˆë‹¤.

1. ì´ì „ í˜ì´ì§€ì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°
2. DB ì—°ê²°
3. ì¿¼ë¦¬ì‘ì„±
4. ì¿¼ë¦¬ì „ì†¡
5. ê²°ê³¼ê°’ ê°€ì ¸ì˜¤ê¸°
6. (HTML ë¬¸ì„œ ë¶€ë¶„ì—ì„œ ê²°ê³¼ê°’ì— ë”°ë¥¸ í‘œì‹œ ë‚´ìš©)

### 1. ì´ì „ í˜ì´ì§€ì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°

ì´ì „ í˜ì´ì§€ëŠ” `searchID.php`ì´ë©°,  ì´ì „ í˜ì´ì§€ì—ì„œ **[ê²€ìƒ‰] ë²„íŠ¼**ì„ ëˆ„ë¥´ë©´ í•´ë‹¹ í˜ì´ì§€ì—ì„œ ì²˜ë¦¬ ë° ê²°ê³¼ê°’ì„ ë„ì¶œí•œë‹¤.

ì´ ë•Œ, í•„ìš”í•œ ê°’ì€ **<input>**ì— ì‚¬ìš©ìê°€ ì…ë ¥í•œ **ID value**ì´ë‹¤.

```php
<?php
	$u_id = $_POST["input_id"];
?>
```

### 2. DB ì—°ê²°

`dbcon.php`ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.

```php
<?php
	include "../inc/dbcon.php";
?>
```

### 3. ì¿¼ë¦¬ ì‘ì„±

DBì—ì„œ í•„ìš”í•œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ì—¬ ë³€ìˆ˜ì— ì €ì¥í•œë‹¤.

ì—¬ê¸°ì„ , ì…ë ¥ë°›ì€ IDê°€ ì´ë¯¸ DBì— ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ê°€ í•„ìš”í•˜ë‹¤.

```php
<?php
	$sql = "select u_id from members where u_id='$u_id';";
?>
```

### 4. ì¿¼ë¦¬ ì „ì†¡

ì‘ì„±í•œ ì¿¼ë¦¬ë¥¼ DBì— ì „ì†¡í•œë‹¤.

```php
<?php
	$result = mysqli_query($dbcon, $sql);
?>
```

`mysqli_query("ì—°ê²°ê°ì²´","ì „ë‹¬í•  ì¿¼ë¦¬");`

### 5. DBì—ì„œ ê²°ê³¼ê°’ ê°€ì ¸ì˜¤ê¸°

<aside>
ğŸ’¡ **selectì™€ insert, delete, updateì™€ì˜ ì°¨ì´ì **
  - selectì€ `ë°˜í™˜ë˜ëŠ” ê°’`ì´ ìˆë‹¤.

`**select`, `show`, `describe`, `explain`** ë“±ê³¼ ê°™ì´ ì½ê¸°ì™€ ê´€ë ¨ëœ SQLì„ ì‹¤í–‰í•˜ë©´, return valueë¡œ **mysqli_result** ë¼ê³  í•˜ëŠ” ì–´ë– í•œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.

</aside>

**ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” 3ê°€ì§€**

*`**ì „ì†¡ê°ì²´**:mysqli_query($dbcon,$sql); ==> ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.`*

1. **mysqli_fetch_row(ì „ì†¡ê°ì²´)**
    - *í•„ë“œì˜ ìˆœì„œë¥¼ ì´ìš©í•´ì„œ dataê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
    (rowëŠ” ê°€ë¡œ í–‰ì„ ì˜ë¯¸í•˜ëŠ”ë°, ê°€ì ¸ì˜¤ëŠ” ê°’ì€ ì„¸ë¡œë¡œ ê°€ì ¸ì˜¨ë‹¤.)*
      ex) *ë‚˜ì˜¨ ê²°ê³¼ê°’ ì¤‘ _ë²ˆì§¸ í•„ë“œê°’ ê°€ì ¸ì™€*
    - ì•„ì´ë””ë¡œ goldloadë¥¼ ì…ë ¥í–ˆì„ ë•Œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ë©´,
    *(#goldloadëŠ” ì´ë¯¸ DBì— ìˆëŠ” ê°’)*
    `$row`ëŠ” ì•„ì´ë””ê°€ **goldload**ì¸ ë°ì´í„°ì—ì„œ í•„ë“œê°€ `u_id`ì¸ ê°’ì„ í•˜ë‚˜ ê°€ì§€ê³ , ê·¸ê²ƒì´ 0ë²ˆì§¸ ì´ë¯€ë¡œ **goldload**ê°€ ì¶œë ¥ëœë‹¤.

        ```php
        <?php
        	$row = mysqli_fetch_row($result);
          echo $row[0];
        ?>

        ```

        ![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/4bf7ca65-cfde-409f-9b0e-4306cbedfff6/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211220T083734Z&X-Amz-Expires=86400&X-Amz-Signature=8b6ac6f8fc1ba9288b0d01c63791e1ec04044681cb77b37e4509a4f664a83834&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)


2. **mysqli_fetch_array(ì „ì†¡ê°ì²´)**
    - *í•„ë“œëª…ìœ¼ë¡œ dataê°’ì„ ê°€ì ¸ì˜¨ë‹¤.*
    - ì•„ì´ë””ë¡œ **goldload**ë¥¼ ì…ë ¥í–ˆì„ ë•Œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ë©´,
    *(#goldloadëŠ” ì´ë¯¸ DBì— ìˆëŠ” ê°’)*
    ì•ì„œ **"select"**ë¬¸ì„ u_idì—ì„œ *ë¡œ ë³€ê²½í•˜ê³  ì‹¤í–‰í•˜ë©´ `$array`ëŠ” `[í•„ë“œëª…1]=ê°’1, [í•„ë“œëª…2]=ê°’2,...` í˜•íƒœì˜ ë°°ì—´ì„ ê°€ì§ˆ ê²ƒì´ë‹¤.
    `$array["u_name"]` ì€ ë°°ì—´ ì¤‘ u_name í•„ë“œì˜ ê°’ì„ ì˜ë¯¸í•œë‹¤.

        ```php
        <?php
        	$sql = "select * from members where u_id='$u_id';";

        	$array = mysqli_fetch_array($result);
          echo $array["u_name"];
        ?>
        ```

        ![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/01faee2a-f2d6-4af8-99c8-1df62d3faa52/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211220T083754Z&X-Amz-Expires=86400&X-Amz-Signature=701308f31124c7b9bd846df35d331fdfea8b119d8eb19e6bddd8e6726789bf3d&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)


3. **mysqli_num_rows(ì „ì†¡ê°ì²´)**
    - *ê²°ê³¼ í–‰ì˜ ê°œìˆ˜ (select count(*) from members;)ë¥¼ ë‚˜íƒ€ë‚´ë©°,
    ë§Œì•½ ìˆ«ìê°€ 0ì´ ë‚˜ì˜¤ë©´ ì¤‘ë³µë˜ëŠ” ì•„ì´ë””ê°€ ì—†ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.*
    - ì•„ì´ë””ë¡œ **goldload**ë¥¼ ì…ë ¥í–ˆì„ ë•Œ ë‹¤ìŒì„ ì‹¤í–‰í•˜ë©´,
    *(#goldloadëŠ” ì´ë¯¸ DBì— ìˆëŠ” ê°’)*
    `$num`ì€ u_idê°€ **goldload**ì¸  ë°ì´í„°í–‰ì˜ ê°œìˆ˜ë¥¼ ê°€ì§ˆ ê²ƒì´ë‹¤.

        ```php
        <?php
        	$num = mysqli_num_rows($result);
          echo $num;
        ?>
        ```

        ![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/08ac3b0c-2bbe-4601-b1f5-9a89b077d0dd/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211220T083803Z&X-Amz-Expires=86400&X-Amz-Signature=bf3ef626b9bd9c2996cea771f8e376432738596e203da5fc20d4208111a74a47&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)


ì—¬ê¸°ì„œëŠ” ì¤‘ë³µë˜ëŠ”ì§€ ì—¬ë¶€ê°€ í•„ìš”í•˜ë‹ˆê¹Œ **mysqli_num_rows() ì‚¬ìš©**

```php
<?php
	$num = mysqli_num_rows($result);
?>
```

### HTML ë¬¸ì„œ ë¶€ë¶„ì—ì„œ ê²°ê³¼ê°’ì— ë”°ë¥¸ í‘œì‹œ ë‚´ìš©

```php
<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²€ìƒ‰ ê²°ê³¼</title>
  <style type="text/css">
  body, button {font-size: 16px;}
  a {text-decoration: none; color: rgb(9, 124, 266);}
  a:hover {color: rgb(255, 153, 0);}
  .bid {font-weight: bold;}
  .able {font-weight: bold; color: rgb(0, 110, 253);}
  .d_able {font-weight: bold; color: rgb(255, 123, 0);}
  </style>

  <?php if(!$num){ ?>
	  <script type="text/javascript">
	  function return_id() {
	    opener.document.getElementById("u_id").value = "<?php echo $u_id; ?>";
	    window.close();
	  };
	  **// ë³´ì•ˆì  ìš”ì†Œë¡œ í•˜ë‹¨ [ì‚¬ìš©í•˜ê¸°]ê°€ í™œì„±ë ë•Œë§Œ ë‚˜ì˜¤ë„ë¡ í•¨.**
	  </script>
  <?php }; ?>
</head>

<body>
  <p>ì…ë ¥í•˜ì‹  <span class="bid"><?php echo $u_id; ?></span>ì€ ì‚¬ìš©í•  ìˆ˜
    <!--
      <?php
        if(!$num){ //if($num ==0)
          echo "<span class=\"able\">ìˆëŠ”</span>";
        }else{
          echo "<span class=\"d_able\">ì—†ëŠ”</span>";
        }
      ?>
    -->

    <!-- phpë¬¸ì¥ ì•ˆì— htmlë¬¸ì¥ ìˆìœ¼ë©´ phpë¬¸ì¥ìœ¼ë¡œ ì¸ì‹í•¨ -->
    <?php
        if(!$num){ //if($num ==0) ?>
    <span class="able">ìˆëŠ”</span>
    <?php }else{ ?>
    <span class="d_able">ì—†ëŠ”</span>
    <?php };  ?>

    ì•„ì´ë””ì…ë‹ˆë‹¤.<br><br>

    <!-- ìœ„ì™€ ë™ì¼ ì¡°ê±´ì¼ ë•Œë§Œ ì´ê²Œ ë³´ì„ -->
    <!-- ê´€ë¦¬ìë§Œ ë³¼ ìˆ˜ ìˆëŠ” ë©”ë‰´,
         ë¡œê·¸ì¸í•œ ì •ë³´ê°€ ê´€ë¦¬ìì¼ ë•Œ ê´€ë¦¬ììš© ë©”ë‰´ ë³´ì´ê¸° -->
    <?php if(!$num){ ?>
    <a href="#" onclick="return_id()">[ì‚¬ìš©í•˜ê¸°]</a>
    <?php }; ?>
    <a href="#" onclick="history.back()">[ë‹¤ì‹œ ê²€ìƒ‰]</a>
  </p>
</body>

</html>
```

---